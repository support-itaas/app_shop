<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>
        <template id="product_stock_report_id">
            <!--<t t-foreach="doc" t-as="o">-->
            <div class="header">

                <!--<t t-set="product_name" t-value="0"/>-->
                <!--<t t-set="product_uom" t-value="0"/>-->
                <!--<t t-foreach="docs" t-as="product">-->
                    <!--<t t-foreach="doc_model.get_stock_move_by_product_by_date(data['date_from'],data['date_to'],product)" t-as="move">-->
                        <!--<t t-set="product_name" t-value="move['name']"/>-->
                        <!--<t t-set="product_uom" t-value="move['uom']"/>-->
                    <!--</t>-->
                <!--</t>-->

                <t t-set="product_name" t-value="product_id.name"/>
                <t t-set="product_uom" t-value="product_id.uom_id.name"/>

                <div style="text-align:center">
                    <font style="font-size: 18px;">
                        <strong>รายงานสินค้าและวัตถุดิบ</strong>
                    </font>
                </div><p/>
                <div style="text-align:center">
                    <font style="font-size: 14px;">
                        <span>ณ วันที่</span>&amp;nbsp;&amp;nbsp;<span t-esc="date_to"/>
                    </font>
                </div><p/>
                <div class="col-xs-12">
                    <font style="font-size: 14px;">
                        <span><b>ชื่อผู้ประกอบการ</b></span>&amp;nbsp;&amp;nbsp;
                        <span t-esc="company_id.name" />
                        <span style="position: absolute;left: 55%;"><b>เลขประจำตัวผู้เสียภาษีอากร</b></span>&amp;nbsp;&amp;nbsp;
                        <span style="position: absolute;left: 78%;" t-field="company_id.vat"/><br/>
                        <span><b>ชื่อสถานประกอบการ</b></span>&amp;nbsp;&amp;nbsp;
                        <span t-esc="company_id.name" />
                        <span style="position: absolute;left: 55%;">[X]</span>
                        <span style="position: absolute;left: 58%;"><b>สำนักงานใหญ่</b></span>&amp;nbsp;&amp;nbsp;
                        <span style="position: absolute;left: 70%;"><b>สาขาที่</b></span>&amp;nbsp;&amp;nbsp;
                        <span style="position: absolute;left: 77%;">00000</span><br/>
                        <strong>ชื่อสินค้า / วัตถุดิบ</strong>&amp;nbsp;&amp;nbsp;
                        <span t-esc="product_name"/>
                        <!--<strong>ชนิด / ขนาด</strong>&amp;nbsp;&amp;nbsp;-->
                        <!--<span/>-->
                        <span style="position: absolute;left: 55%;"><b>ปริมาณนับเป็น</b></span>&amp;nbsp;&amp;nbsp;
                        <span style="position: absolute;left: 65%;" t-esc="product_uom"/>
                        <!--<span><b>จากวันที่ </b></span>&amp;nbsp;&amp;nbsp;-->
                        <!--<span t-esc="date_from"/>-->
                        <!--<span><b>ถึงวันที่ </b></span>&amp;nbsp;&amp;nbsp;-->
                        <!--<span t-esc="date_to"/>-->

                    </font>
                </div>
            </div>

            <br/><br/>
            <div class="page">
                <style>
                    .header{width:100%; height:50px;}
                    .content{width:100%; height:600px;}
                    .footer{width:100%; height:200px;}
                    .doubleUnderline{border-bottom: 3px double;}
                    table.table-bordered1{
                    border:1px solid black;
                    margin-top:20px;
                    border-collapse: collapse;
                    width: 100%;
                    }
                    table.table-bordered1 &gt; thead &gt; tr &gt; th{
                    border:1px solid black;
                    border-collapse: collapse;
                    }
                    table.table-bordered1 &gt; tbody &gt; tr &gt; td{
                    border:0px solid white;
                    border-left: 1px solid black;
                    border-collapse: collapse;
                    height: 40px;
                    }
                    table.table-bordered1 &gt; tfoot &gt; tr &gt; td{
                    border:1px solid black;
                    border-collapse: collapse;
                    }
                    table.table-bordered &gt; thead &gt; tr &gt; th{
                    border:1px solid black;
                    border-collapse: collapse;
                    }
                    table.table-bordered &gt; tbody &gt; tr &gt; td{
                    border:1px solid black;
                    <!--border-left: 1px solid;-->
                    border-collapse: collapse;
                    }
                    table.table-bordered &gt; tfoot &gt; tr &gt; td{
                    border:1px solid black;
                    border-collapse: collapse;
                    }
                    table.table-table1 {
                    border:1px solid black;
                    margin-top:20px;
                    border-collapse: collapse;
                    border-left: 1px solid;
                    border-right: 1px solid;
                    border-bottom: 1px solid;
                    border-top: 1px solid;
                    width: 100%;
                    }
                </style>
                <div class="content">
                    <div class="col-xs-12">
                        <table class="table table-bordered1" style="width:100%">
                            <thead>
                                <tr>
                                    <!--<th rowspan="2" style="text-align:center"><b>ชื่อสินค้า</b></th>-->
                                    <!--<th rowspan="2" style="text-align:center"><b>หน่วย</b></th>-->
                                    <th rowspan="3" style="text-align:center; vertical-align: middle;"><b>ชนิดเอกสาร</b></th>
                                    <th rowspan="3" style="text-align:center; vertical-align: middle;"><b>เลขที่ใบสำคัญ</b></th>
                                    <th rowspan="3" style="text-align:center; vertical-align: middle;"><b>เลขที่อ้างอิง</b></th>
                                    <th rowspan="3" style="text-align:center; vertical-align: middle;"><b>วัน เดือน ปี</b></th>
                                    <th colspan="9" style="text-align:center; vertical-align: middle;"><b>ปริมาณสินค้าวัตถุดิบ</b></th>
                                    <!--<th rowspan="2" style="text-align:center"><b>ราคา</b></th>-->
                                    <th rowspan="3" style="text-align:center; vertical-align: middle;"><b>หมายเหตุ</b></th>
                                </tr>
                                <tr>
                                    <th colspan="3" style="text-align:center"><b>รับ</b></th>
                                    <th colspan="3" style="text-align:center"><b>จ่าย</b></th>
                                    <th colspan="3" style="text-align:center"><b>คงเหลือ</b></th>
                                </tr>
                                <tr>
                                    <th style="text-align:center"><b>ปริมาณ</b></th>
                                    <th style="text-align:center"><b>ราคา/หน่วย</b></th>
                                    <th style="text-align:center"><b>จำนวนเงิน</b></th>

                                    <th style="text-align:center"><b>ปริมาณ</b></th>
                                    <th style="text-align:center"><b>ราคา/หน่วย</b></th>
                                    <th style="text-align:center"><b>จำนวนเงิน</b></th>

                                    <th style="text-align:center"><b>ปริมาณ</b></th>
                                    <th style="text-align:center"><b>ราคา/หน่วย</b></th>
                                    <th style="text-align:center"><b>จำนวนเงิน</b></th>
                                </tr>

                            </thead>
                            <tbody class="sale_tbody">
                                <t t-set="i" t-value="1"/>
                                <t t-set="duration" t-value="0"/>
                                <t t-set="sum_use" t-value="0"/>
                                <t t-set="sum_add" t-value="0"/>
                                <t t-set="uom" t-value="0"/>
                                <t t-set="balance" t-value="0"/>
                                <t t-set="sum_total_price_add" t-value="0"/>
                                <t t-set="sum_total_price_use" t-value="0"/>
                                <t t-set="sum_total_price1" t-value="0"/>
                                <t t-set="sum_total_price" t-value="0"/>
                                <t t-set="price1" t-value="0"/>
                                <t t-set="sum_qty1" t-value="0"/>

                                <t t-foreach="docs" t-as="product">
                                    <t t-set="before" t-value="doc_model.get_inventory_before(data['date_from'],product)"/>
                                    <t t-foreach="before" t-as="history">
                                        <t t-set="sum_total_price" t-value="history['qty'] * history['cost']"/>
                                        <t t-set="price1" t-value="price1 + sum_total_price"/>
                                        <t t-set="sum_qty1" t-value="sum_qty1 + history['qty']"/>
                                        <!--<t t-foreach="doc_model.get_stock_move_by_product_by_date(data['date_from'],data['date_to'],product)" t-as="move">-->
                                        <tr>
                                            <td style="text-align:center"><span>ยอดยกมา</span></td>
                                            <td style="text-align:center"><span t-esc="history['reference_name']"/></td>
                                            <td style="text-align:center"><span/></td>
                                            <td style="text-align:center"><!--<span t-esc="history['date']"/>--></td>
                                            <td style="text-align:right"><span t-esc="'{0:,.2f}'.format(float(history['qty']))"/></td>
                                            <td style="text-align:right"><span t-esc="'{0:,.2f}'.format(float(history['cost']))"/></td>
                                            <td style="text-align:right"><span t-esc="'{0:,.2f}'.format(float(sum_total_price))"/></td>
                                            <td style="text-align:center"><span/></td>
                                            <td style="text-align:center"><span/></td>
                                            <td style="text-align:center"><span/></td>
                                            <td style="text-align:right"><span t-esc="'{0:,.2f}'.format(float(history['qty']))"/></td>
                                            <td style="text-align:right"><span t-esc="'{0:,.2f}'.format(float(history['cost']))"/></td>
                                            <td style="text-align:right"><span t-esc="'{0:,.2f}'.format(float(sum_total_price))"/></td>
                                            <td style="text-align:center"><span/></td>
                                        </tr>
                                        <!--</t>-->
                                    </t>
                                    <t t-if="not before">

                                        <!--<t t-foreach="doc_model.get_stock_move_by_product_by_date(data['date_from'],data['date_to'],product)" t-as="move">-->
                                        <tr>
                                            <td style="text-align:center"><span>ยอดยกมา</span></td>
                                            <td style="text-align:center"><span></span></td>
                                            <td style="text-align:center"><span/></td>
                                            <td style="text-align:center"><!--<span t-esc="history['date']"/>--></td>
                                            <td style="text-align:right"><span>0.00</span></td>
                                            <td style="text-align:right"><span>0.00</span></td>
                                            <td style="text-align:right"><span>0.00</span></td>
                                            <td style="text-align:center"><span/></td>
                                            <td style="text-align:center"><span/></td>
                                            <td style="text-align:center"><span/></td>
                                            <td style="text-align:right"><span>0.00</span></td>
                                            <td style="text-align:right"><span>0.00</span></td>
                                            <td style="text-align:right"><span>0.00</span></td>
                                            <td style="text-align:center"><span/></td>
                                        </tr>
                                    </t>
                                    <!--</t>-->

                                    <!--<t t-foreach="doc_model.get_inventory_after(data['date_to'],product)" t-as="history">-->
                                    <t t-set="transaction" t-value="doc_model.get_stock_move_by_product_by_date(data['date_from'],data['date_to'],product)"/>
                                    <t t-foreach="transaction" t-as="move">
                                        <!--<t t-set="i" t-value="i+1"/>-->
                                        <t t-set="duration" t-value="move['duration']"/>
                                        <t t-set="sum_add" t-value="move['sum_add']"/>
                                        <t t-set="sum_use" t-value="move['sum_use']"/>
                                        <t t-set="sum_total_price_use" t-value="move['sum_total_price_use']"/>
                                        <t t-set="sum_total_price_add" t-value="move['sum_total_price_add']"/>
                                        <t t-set="uom" t-value="move['uom']"/>
                                        <t t-set="land_cost_ids" t-value="doc_model.get_land_cost_by_move_by_product(move['move_id'],product)"/>

                                        <t t-set="balance" t-value="move['balance']"/>
                                        <tr>
                                            <!--<td style="text-align:center"><span t-esc="move['name']"/></td>-->
                                            <!--<td style="text-align:center"><span t-esc="move['uom']"/></td>-->

                                            <!--################ move type ########-->
                                            <!--#1- purchase-->
                                            <!--#2- sale-->
                                            <!--#3- production-out (use matterial)-->
                                            <!--#4- return-supplier(return to supplier)-->
                                            <!--#5- return-customer(return from customer)-->
                                            <!--#6- set (ยอดยกมาก)-->
                                            <!--#7- production-in (transfer from production to stock)-->
                                            <!--#8- inventory-lost(ของเสีย ของหาย)-->
                                            <!--############################-->

                                            <t t-if="move['type'] == 'purchase'">
                                                <td style="text-align:center">
                                                    <span>ซื้อ</span>
                                                </td>
                                            </t>
                                            <t t-if="move['type'] == 'sale'">
                                                <td style="text-align:center">
                                                    <span>ขาย</span>
                                                </td>
                                            </t>
                                            <t t-if="move['type'] == 'production-out'">
                                                <td style="text-align:center">
                                                    <span>ใช้ผลิต</span>
                                                </td>
                                            </t>
                                            <t t-if="move['type'] == 'production-in'">
                                                <td style="text-align:center">
                                                    <span>ผลิต</span>
                                                </td>
                                            </t>
                                            <t t-if="move['type'] == 'return-supplier'">
                                                <td style="text-align:center">
                                                    <span>คืนผู้จำหน่าย</span>
                                                </td>
                                            </t>
                                            <t t-if="move['type'] == 'return-customer'">
                                                <td style="text-align:center">
                                                    <span>ลูกค้าคืนของ</span>
                                                </td>
                                            </t>
                                            <t t-if="move['type'] == 'set'">
                                                <td style="text-align:center">
                                                    <span>ยอดยกมา</span>
                                                </td>
                                            </t>
                                            <t t-if="move['type'] == 'inventory-lost'">
                                                <td style="text-align:center">
                                                    <span>ของเสีย ของหาย</span>
                                                </td>
                                            </t>
                                            <t t-if="move['type'] == 'credit'">
                                                <td style="text-align:center">
                                                    <span>ลดหนี้</span>
                                                </td>
                                            </t>
                                            <t t-if="move['type'] == 'debit'">
                                                <td style="text-align:center">
                                                    <span>เพิ่มหนี้</span>
                                                </td>
                                            </t>
                                            <t t-if="move['type'] == ''">
                                                <td style="text-align:center">
                                                    <span>อื่นๆ</span>
                                                </td>
                                            </t>

                                            <td style="text-align:center"><span t-esc="move['reference']"/></td>
                                            <td style="text-align:center"><span t-esc="move['no_ref']"/></td>
                                            <td style="text-align:center"><span t-esc="move['date']"/></td>
                                            <t t-if="move['move_in']">
                                                <t t-if="move['qty']">
                                                    <td style="text-align:right"><span t-esc="'{0:,.2f}'.format(float(move['qty']))"/></td>
                                                    <td style="text-align:right"><span t-esc="'{0:,.2f}'.format(float(move['price']))"/></td>
                                                </t>
                                                <t t-if="not move['qty']">
                                                    <td style="text-align:right"></td>
                                                    <td style="text-align:right"></td>
                                                </t>
                                                <td style="text-align:right"><span t-esc="'{0:,.2f}'.format(float(move['total_price']))"/></td>
                                                <td style="text-align:center"><span></span></td>
                                                <td style="text-align:center"><span></span></td>
                                                <td style="text-align:center"><span></span></td>
                                            </t>
                                            <t t-if="not move['move_in']">
                                                <td style="text-align:center"><span></span></td>
                                                <td style="text-align:center"><span></span></td>
                                                <td style="text-align:center"><span></span></td>
                                                <td style="text-align:right">
                                                    <t t-foreach="doc_model.get_stock_move_out_quant_split_lot(move['move_id'])" t-as="move_quant">
                                                        <span t-esc="'{0:,.2f}'.format(float(move_quant['qty']))"/><br/>
                                                    </t>
                                                </td>
                                                <td style="text-align:right">
                                                    <t t-foreach="doc_model.get_stock_move_out_quant_split_lot(move['move_id'])" t-as="move_quant">
                                                        <span t-esc="'{0:,.2f}'.format(float(move_quant['price']))"/><br/>
                                                    </t>
                                                </td>

                                                <td style="text-align:right">
                                                    <t t-foreach="doc_model.get_stock_move_out_quant_split_lot(move['move_id'])" t-as="move_quant">
                                                        <span t-esc="'{0:,.2f}'.format(float(move_quant['total_price']))"/><br/>
                                                    </t>
                                                </td>
                                            </t>

                                            <!--###################for balance###############-->
                                            <t t-set="after" t-value="doc_model.get_inventory_after(before,move)"/>
                                            <t t-set="sum_qty1" t-value="0.0"/>
                                            <t t-set="price1" t-value="0.0"/>
                                            <t t-if="after">
                                                <td style="text-align:right">
                                                    <t t-foreach="after" t-as="history">
                                                        <t t-set="sum_qty" t-value="history['qty']"/>
                                                        <t t-set="sum_qty1" t-value="sum_qty1 + sum_qty"/>
                                                        <t t-if="history['qty'] != 0.0">
                                                            <span t-esc="'{0:,.2f}'.format(float(history['qty']))"/><br/>
                                                        </t>
                                                    </t>
                                                </td>
                                                <td style="text-align:right">
                                                    <t t-foreach="after" t-as="history">
                                                        <t t-if="history['qty'] != 0.0">
                                                            <span t-esc="'{0:,.2f}'.format(float(history['cost']))"/><br/>
                                                        </t>
                                                    </t>
                                                </td>
                                                <td style="text-align:right">
                                                    <t t-foreach="after" t-as="history">
                                                        <t t-set="price" t-value="history['cost'] * history['qty']"/>
                                                        <t t-set="price1" t-value="price1 + price"/>
                                                        <t t-if="history['qty'] != 0.0">
                                                            <span t-esc="'{0:,.2f}'.format(float(price))"/><br/>
                                                        </t>
                                                    </t>
                                                </td>
                                                <!--<td style="text-align:center"><span t-esc="'{0:,.2f}'.format(float(history['qty']))"/><br/></td>-->
                                                <!--<td style="text-align:center"><span t-esc="'{0:,.2f}'.format(float(history['qty']))"/><br/></td>-->
                                                <!--###################for balance###############-->
                                                <td style="text-align:center"><span t-esc="move['remark']"/></td>
                                            </t>
                                        </tr>
                                        <t t-set="before" t-value="after"/>
                                        <t t-if="land_cost_ids">
                                            <t t-set="count_land_cost" t-value="0"/>
                                            <t t-foreach="land_cost_ids" t-as="land_cost">
                                                <t t-set="count_land_cost" t-value="count_land_cost+1"/>

                                                <tr>
                                                    <t t-if="land_cost['type'] == 'purchase'">
                                                        <td style="text-align:center">
                                                            <span>ซื้อ</span>
                                                        </td>
                                                    </t>
                                                    <t t-if="land_cost['type'] == 'sale'">
                                                        <td style="text-align:center">
                                                            <span>ขาย</span>
                                                        </td>
                                                    </t>
                                                    <t t-if="land_cost['type'] == 'production-out'">
                                                        <td style="text-align:center">
                                                            <span>ใช้ผลิต</span>
                                                        </td>
                                                    </t>
                                                    <t t-if="land_cost['type'] == 'production-in'">
                                                        <td style="text-align:center">
                                                            <span>ผลิต</span>
                                                        </td>
                                                    </t>
                                                    <t t-if="land_cost['type'] == 'return-supplier'">
                                                        <td style="text-align:center">
                                                            <span>คืนผู้จำหน่าย</span>
                                                        </td>
                                                    </t>
                                                    <t t-if="land_cost['type'] == 'return-customer'">
                                                        <td style="text-align:center">
                                                            <span>ลูกค้าคืนของ</span>
                                                        </td>
                                                    </t>
                                                    <t t-if="land_cost['type'] == 'set'">
                                                        <td style="text-align:center">
                                                            <span>ยอดยกมา</span>
                                                        </td>
                                                    </t>
                                                    <t t-if="land_cost['type'] == 'inventory-lost'">
                                                        <td style="text-align:center">
                                                            <span>ของเสีย ของหาย</span>
                                                        </td>
                                                    </t>
                                                    <t t-if="land_cost['type'] == 'credit'">
                                                        <td style="text-align:center">
                                                            <span>ลดหนี้</span>
                                                        </td>
                                                    </t>
                                                    <t t-if="land_cost['type'] == 'debit'">
                                                        <td style="text-align:center">
                                                            <span>เพิ่มหนี้</span>
                                                        </td>
                                                    </t>
                                                    <t t-if="land_cost['type'] == ''">
                                                        <td style="text-align:center">
                                                            <span>อื่นๆ</span>
                                                        </td>
                                                    </t>

                                                    <td style="text-align:center"><span t-esc="land_cost['reference']"/></td>
                                                    <td style="text-align:center"><span t-esc="land_cost['no_ref']"/></td>
                                                    <td style="text-align:center"><span t-esc="land_cost['date']"/></td>
                                                    <t t-if="land_cost['move_in']">

                                                        <t t-if="land_cost['qty']">
                                                            <td style="text-align:right"><span t-esc="'{0:,.2f}'.format(float(land_cost['qty']))"/></td>
                                                            <td style="text-align:right"><span t-esc="'{0:,.2f}'.format(float(land_cost['price']))"/></td>
                                                        </t>
                                                        <t t-if="not land_cost['qty']">
                                                            <td style="text-align:right"></td>
                                                            <td style="text-align:right"></td>
                                                        </t>
                                                        <td style="text-align:right"><span t-esc="'{0:,.2f}'.format(float(land_cost['total_price']))"/></td>

                                                        <td style="text-align:center"><span></span></td>
                                                        <td style="text-align:center"><span></span></td>
                                                        <td style="text-align:center"><span></span></td>
                                                    </t>
                                                    <t t-if="not land_cost['move_in']">
                                                        <td style="text-align:center"><span></span></td>
                                                        <td style="text-align:center"><span></span></td>
                                                        <td style="text-align:center"><span></span></td>


                                                        <t t-if="land_cost['qty']">
                                                            <td style="text-align:right"><span t-esc="'{0:,.2f}'.format(float(land_cost['qty']))"/></td>
                                                            <td style="text-align:right"><span t-esc="'{0:,.2f}'.format(float(land_cost['price']))"/></td>
                                                        </t>
                                                        <t t-if="not land_cost['qty']">
                                                            <td style="text-align:right"></td>
                                                            <td style="text-align:right"></td>
                                                        </t>
                                                        <td style="text-align:right"><span t-esc="'{0:,.2f}'.format(float(land_cost['total_price']))"/></td>

                                                    </t>
                                                    <!--###################for balance###############-->
                                                    <t t-set="after" t-value="doc_model.get_inventory_after(before,land_cost)"/>
                                                    <t t-set="sum_qty1" t-value="0.0"/>
                                                    <t t-set="price1" t-value="0.0"/>
                                                    <t t-if="after">
                                                        <td style="text-align:right">
                                                            <t t-foreach="after" t-as="history">
                                                                <t t-set="sum_qty" t-value="history['qty']"/>
                                                                <t t-set="sum_qty1" t-value="sum_qty1 + sum_qty"/>
                                                                <t t-if="history['qty'] != 0.0">
                                                                    <span t-esc="'{0:,.2f}'.format(float(history['qty']))"/><br/>
                                                                </t>
                                                            </t>
                                                        </td>
                                                        <td style="text-align:right">
                                                            <t t-foreach="after" t-as="history">
                                                                <t t-if="history['qty'] != 0.0">
                                                                    <span t-esc="'{0:,.2f}'.format(float(history['cost']))"/><br/>
                                                                </t>
                                                            </t>
                                                        </td>
                                                        <td style="text-align:right">
                                                            <t t-foreach="after" t-as="history">
                                                                <t t-set="price" t-value="history['cost'] * history['qty']"/>
                                                                <t t-set="price1" t-value="price1 + price"/>
                                                                <t t-if="history['qty'] != 0.0">
                                                                    <span t-esc="'{0:,.2f}'.format(float(price))"/><br/>
                                                                </t>
                                                            </t>
                                                        </td>
                                                        <!--<td style="text-align:center"><span t-esc="'{0:,.2f}'.format(float(history['qty']))"/><br/></td>-->
                                                        <!--<td style="text-align:center"><span t-esc="'{0:,.2f}'.format(float(history['qty']))"/><br/></td>-->
                                                        <!--###################for balance###############-->
                                                        <td style="text-align:center"><span t-esc="land_cost['remark']"/></td>
                                                    </t>
                                                    <t t-set="before" t-value="after"/>
                                                </tr>
                                            </t>

                                        </t>
                                    </t>

                                    <tr height="1px">
                                        <td style="border-bottom:1px solid black"/>
                                        <td style="border-bottom:1px solid black"/>
                                        <td style="border-bottom:1px solid black"/>
                                        <td style="border-bottom:1px solid black"/>
                                        <td style="border-bottom:1px solid black"/>
                                        <td style="border-bottom:1px solid black"/>
                                        <td style="border-bottom:1px solid black"/>
                                        <td style="border-bottom:1px solid black"/>
                                        <td style="border-bottom:1px solid black"/>
                                        <td style="border-bottom:1px solid black"/>
                                        <td style="border-bottom:1px solid black"/>
                                        <td style="border-bottom:1px solid black"/>
                                        <td style="border-bottom:1px solid black"/>
                                        <td style="border-bottom:1px solid black"/>
                                    </tr>
                                    <tr style="text-align:right; border-bottom:1px solid black;">
                                        <td colspan="10" style="text-align:right; border-bottom:1px solid black;">
                                            <span>รวมคงเหลือ</span>
                                        </td>
                                        <td style="text-align:right; border-bottom:1px solid black;">
                                            <span t-esc="'{0:,.2f}'.format(float(sum_qty1))"/><br/>
                                        </td>
                                        <td style="text-align:right; border-bottom:1px solid black;"> </td>
                                        <td style="text-align:right; border-bottom:1px solid black;">
                                            <span t-esc="'{0:,.2f}'.format(float(price1))"/><br/>
                                        </td>
                                        <td style="text-align:right; border-bottom:1px solid black;"> </td>
                                    </tr>

                                    <tr style="text-align:right; border-bottom:1px solid black;">
                                        <td style="text-align:right; border-bottom:1px solid black;" colspan="4">
                                            <span>มูลค่าสินค้าคงเหลือต้นงวด</span>
                                        </td>
                                        <td colspan="3" style="text-align:right; border-bottom:1px solid black;">
                                            <t t-set="before" t-value="doc_model.get_inventory_before(data['date_from'],product)"/>
                                            <t t-foreach="before" t-as="history">
                                                <t t-set="sum_total_price" t-value="sum_total_price + (history['qty'] * history['cost'])"/>
                                            </t>
                                            <span t-esc="'{0:,.2f}'.format(float(sum_total_price))"/><br/>
                                        </td>
                                        <td style="text-align:right; border-bottom:1px solid black;" colspan="5">
                                            <span>มูลค่าสินค้าคงเหลือปลายงวด</span>
                                        </td>
                                        <td style="text-align:right; border-bottom:1px solid black;">
                                            <span t-esc="'{0:,.2f}'.format(float(price1))"/><br/>
                                        </td>
                                        <td style="text-align:right; border-bottom:1px solid black;"> </td>
                                    </tr>
                                </t>
                            </tbody>
                        </table>
                    </div>
                </div>

            </div>
            <!--</t>-->
        </template>
    </data>
</openerp>

